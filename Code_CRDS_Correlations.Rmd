---
title: "Code_TestCorrelations"
author: "Edna Chiang"
date: "12/14/2021"
output: html_document
---

### Load Packages, scripts, and functions
```{r}
library(ggplot2)
library(plyr)
library(dplyr)
library(grid)
library(MESS)
library(pgirmess)
library(Bolstad2)
library(phyloseq)
library(psych)
library(car)
source('scripts/import_crds.R')
source('scripts/bin_crds.R')
source('scripts/misc.R')
source('scripts/calc_delta_metrics.R')
set.seed(1)
theme_set(theme_bw())

### Stats Notes
# Use 'subset' in kruskal.test
# Do NOT use 'subset' in kruskalmc or pairwise.wilcox.test; it doesn't work!
```

### Load Data
```{r}
crds <- import.crds('CSV', 'metadata.csv')
```

### Bin RelTime
```{r}
crds.bin <- bin.crds(crds)
```


### Summarize by Substrate + ABX
```{r}
### Remove Inulin outliers
#crds.rem <- crds.bin[-which(crds.bin$ID == "S34"),]
crds.rem <- crds.bin[-which(crds.bin$ID == "S37"),]
  # ABX didn't work; high [DNA]
crds.rem <- crds.rem[-which(crds.rem$ID == "P28"),]
#crds.rem <- crds.rem[-which(crds.rem$ID == "P30"),]

# Remove Saline outliers
#crds.rem <- crds.rem[-which(crds.rem$ID == "W26"),]
crds.rem <- crds.rem[-which(crds.rem$ID == "W43"),]
crds.rem <- crds.rem[-which(crds.rem$ID == "W50"),]
crds.rem <- crds.rem[-which(crds.rem$ID == "P04"),]
  # This is an adult, not pup

crds.rem$Season <- ordered(crds.rem$Season, levels=c("Summer", "Winter", "Spring"))


# Summarize
crds.sum <- crds.rem %>%
  group_by(Substrate, Antibiotics, Season, BinTime) %>%
  summarize(Y_Mean = mean(Delta),
            Y_Median = median(Delta),
            Y_SD = sd(Delta),
            Y_SE = se(Delta),
            Y_IQR = IQR(Delta),
            X_Mean = mean(RelTime),
            X_Median = median(RelTime),
            X_SD = sd(RelTime),
            X_SE = se(RelTime),
            X_IQR = IQR(RelTime),
            SampSize = n())
  # X_Mean is different from BinTime because BinTime was calculated with ABX and non-ABX combined
    # BinTime was calculated this way to make sure datapoints for all individuals will align together on x-axis. If datapoints are misaligned that can be confusing for the audience. So binning was done this way for the clearest visualization.
    # X_Mean is calculated for ABX and non-ABX separately, so there will be some variation
crds.sum$Season <- ordered(crds.sum$Season, levels=c("Summer", "Winter", "Spring"))
```


### Calculate Delta Metrics
```{r}
# Calculate delta metrics
d.metrics <- calc.delta.metrics(crds.rem)
#write.csv(d.metrics, "delta_metrics.csv", row.names = F)

# Load metadata
meta <- read.csv('metadata.csv')

# Add metadata to delta metrics
d.metrics[,colnames(meta)[3:12]] <- NA
for(sq in 1:nrow(d.metrics)){
  meta.row <- which(meta$ID == d.metrics$ID[sq])
  d.metrics[sq, 6:15] <- meta[meta.row, 3:12]
}

# Convert to numeric
d.metrics$MaxD <- as.numeric(d.metrics$MaxD)
d.metrics$TimeMaxD <- as.numeric(d.metrics$TimeMaxD)
d.metrics$Slope <- as.numeric(d.metrics$Slope)
d.metrics$SlopeTime <- as.numeric(d.metrics$SlopeTime)

# Order seasons
d.metrics$Season <- ordered(d.metrics$Season, levels=c("Summer", "Winter", "Spring"))

# Separate substrates
d.inu <- d.metrics[which(d.metrics$Substrate == "Inulin"),]
d.sal <- d.metrics[which(d.metrics$Substrate == "Saline"),]

# Separate by substrate + ABX
d.inu.abx <- d.inu[which(d.inu$Antibiotics == "Yes"),]
d.inu.noabx <- d.inu[which(d.inu$Antibiotics == "No"),]
d.sal.abx <- d.sal[which(d.sal$Antibiotics == "Yes"),]
d.sal.noabx <- d.sal[which(d.sal$Antibiotics == "No"),]
```



### Test Slope
```{r}
### Test Normality - Inulin
hist(d.inu.abx$Slope)
qqnorm(d.inu.abx$Slope)
qqline(d.inu.abx$Slope)
shapiro.test(d.inu.abx$Slope)
  # p-value = 0.54
  # Normal
hist(d.inu.noabx$Slope)
qqnorm(d.inu.noabx$Slope)
qqline(d.inu.noabx$Slope)
shapiro.test(d.inu.noabx$Slope)
  # p-value = 0.4073
  # Normal
hist(d.inu.abx$BodyMass)
qqnorm(d.inu.abx$BodyMass)
qqline(d.inu.abx$BodyMass)
shapiro.test(d.inu.abx$BodyMass)
  # p-value = 0.06204
  # Normal
hist(d.inu.noabx$BodyMass)
qqnorm(d.inu.noabx$BodyMass)
qqline(d.inu.noabx$BodyMass)
shapiro.test(d.inu.noabx$BodyMass)
  # p-value = 0.1061
  # Normal
hist(d.inu.abx$BodyTemp)
qqnorm(d.inu.abx$BodyTemp)
qqline(d.inu.abx$BodyTemp)
shapiro.test(d.inu.abx$BodyTemp)
  # p-value = 0.1146
  # Normal
hist(d.inu.noabx$BodyTemp)
qqnorm(d.inu.noabx$BodyTemp)
qqline(d.inu.noabx$BodyTemp)
shapiro.test(d.inu.noabx$BodyTemp)
  # p-value = 0.3356
  # Normal
hist(d.inu.abx$Ketones)
qqnorm(d.inu.abx$Ketones)
qqline(d.inu.abx$Ketones)
shapiro.test(d.inu.abx$Ketones)
  # p-value = 0.004391
  # Not Normal
hist(d.inu.noabx$Ketones)
qqnorm(d.inu.noabx$Ketones)
qqline(d.inu.noabx$Ketones)
shapiro.test(d.inu.noabx$Ketones)
  # p-value = 0.001238
  # Not Normal



### Test Normality - Saline
hist(d.sal.abx$Slope)
qqnorm(d.sal.abx$Slope)
qqline(d.sal.abx$Slope)
shapiro.test(d.sal.abx$Slope)
  # p-value = 0.007636
  # Not Normal
hist(d.sal.noabx$Slope)
qqnorm(d.sal.noabx$Slope)
qqline(d.sal.noabx$Slope)
shapiro.test(d.sal.noabx$Slope)
  # p-value = 1.228e-05
  # Not Normal
hist(d.sal.abx$BodyMass)
qqnorm(d.sal.abx$BodyMass)
qqline(d.sal.abx$BodyMass)
shapiro.test(d.sal.abx$BodyMass)
  # p-value = 0.02654
  # Not Normal
hist(d.sal.noabx$BodyMass)
qqnorm(d.sal.noabx$BodyMass)
qqline(d.sal.noabx$BodyMass)
shapiro.test(d.sal.noabx$BodyMass)
  # p-value = 0.9226
  # Normal
hist(d.sal.abx$BodyTemp)
qqnorm(d.sal.abx$BodyTemp)
qqline(d.sal.abx$BodyTemp)
shapiro.test(d.sal.abx$BodyTemp)
  # p-value = 0.2093
  # Normal
hist(d.sal.noabx$BodyTemp)
qqnorm(d.sal.noabx$BodyTemp)
qqline(d.sal.noabx$BodyTemp)
shapiro.test(d.sal.noabx$BodyTemp)
  # p-value = 0.0617
  # Normal
hist(d.sal.abx$Ketones)
qqnorm(d.sal.abx$Ketones)
qqline(d.sal.abx$Ketones)
shapiro.test(d.sal.abx$Ketones)
  # p-value = 0.0182
  # Not Normal
hist(d.sal.noabx$Ketones)
qqnorm(d.sal.noabx$Ketones)
qqline(d.sal.noabx$Ketones)
shapiro.test(d.sal.noabx$Ketones)
  # p-value = 2.14e-05
  # Not Normal



### Test BodyMass Correlation
cor.test(d.inu.abx$Slope, d.inu.abx$BodyMass, method = "pearson")
  # p-value = 0.3353
cor.test(d.inu.noabx$Slope, d.inu.noabx$BodyMass, method = "pearson")
  # p-value = 0.05717
cor.test(d.sal.abx$Slope, d.sal.abx$BodyMass, method = "spearman")
  # p-value = 0.1474
cor.test(d.sal.noabx$Slope, d.sal.noabx$BodyMass, method = "spearman")
  # p-value = 0.7771


### Test BodyTemp Correlation
cor.test(d.inu.abx$Slope, d.inu.abx$BodyTemp, method = "pearson")
  # p-value = 0.5397
cor.test(d.inu.noabx$Slope, d.inu.noabx$BodyTemp, method = "pearson")
  # p-value = 0.7412
cor.test(d.sal.abx$Slope, d.sal.abx$BodyTemp, method = "spearman")
  # p-value = 0.6344
cor.test(d.sal.noabx$Slope, d.sal.noabx$BodyTemp, method = "spearman")
  # p-value = 0.2201


### Test Ketones Correlation
cor.test(d.inu.abx$Slope, d.inu.abx$Ketones, method = "spearman")
  # p-value = 0.1377
  # rho = 0.3878695
cor.test(d.inu.noabx$Slope, d.inu.noabx$Ketones, method = "spearman")
  # p-value = 0.001904*
  # rho = -0.7136781
cor.test(d.sal.abx$Slope, d.sal.abx$Ketones, method = "spearman")
  # p-value = 0.9702
cor.test(d.sal.noabx$Slope, d.sal.noabx$Ketones, method = "spearman")
  # p-value = 0.7203
```




### Test SlopeTime
```{r}
### Test Normality - Inulin
hist(d.inu.abx$SlopeTime)
qqnorm(d.inu.abx$SlopeTime)
qqline(d.inu.abx$SlopeTime)
shapiro.test(d.inu.abx$SlopeTime)
  # p-value = 3.271e-05
  # Not Normal
hist(d.inu.noabx$SlopeTime)
qqnorm(d.inu.noabx$SlopeTime)
qqline(d.inu.noabx$SlopeTime)
shapiro.test(d.inu.noabx$SlopeTime)
  # p-value = 0.4223
  # Normal



### Test Normality - Saline
hist(d.sal.abx$SlopeTime)
qqnorm(d.sal.abx$SlopeTime)
qqline(d.sal.abx$SlopeTime)
shapiro.test(d.sal.abx$SlopeTime)
  # p-value = 0.005973
  # Not Normal
hist(d.sal.noabx$SlopeTime)
qqnorm(d.sal.noabx$SlopeTime)
qqline(d.sal.noabx$SlopeTime)
shapiro.test(d.sal.noabx$SlopeTime)
  # p-value = 0.351
  # Normal



### Test BodyMass Correlation
cor.test(d.inu.abx$SlopeTime, d.inu.abx$BodyMass, method = "spearman")
  # p-value = 0.2517
cor.test(d.inu.noabx$SlopeTime, d.inu.noabx$BodyMass, method = "pearson")
  # p-value = 0.3422
cor.test(d.sal.abx$SlopeTime, d.sal.abx$BodyMass, method = "spearman")
  # p-value = 0.1286
cor.test(d.sal.noabx$SlopeTime, d.sal.noabx$BodyMass, method = "pearson")
  # p-value = 0.2093


### Test BodyTemp Correlation
cor.test(d.inu.abx$SlopeTime, d.inu.abx$BodyTemp, method = "spearman")
  # p-value = 0.8737
cor.test(d.inu.noabx$SlopeTime, d.inu.noabx$BodyTemp, method = "pearson")
  # p-value = 0.3439
cor.test(d.sal.abx$SlopeTime, d.sal.abx$BodyTemp, method = "spearman")
  # p-value = 0.3324
cor.test(d.sal.noabx$SlopeTime, d.sal.noabx$BodyTemp, method = "pearson")
  # p-value = 0.8783


### Test Ketones Correlation
cor.test(d.inu.abx$SlopeTime, d.inu.abx$Ketones, method = "spearman")
  # p-value = 0.09738
cor.test(d.inu.noabx$SlopeTime, d.inu.noabx$Ketones, method = "spearman")
  # p-value = 0.4216
cor.test(d.sal.abx$SlopeTime, d.sal.abx$Ketones, method = "spearman")
  # p-value = 0.6085
cor.test(d.sal.noabx$SlopeTime, d.sal.noabx$Ketones, method = "spearman")
  # p-value = 0.8088
```




### Test MaxD
```{r}
### Test Normality - Inulin
hist(d.inu.abx$MaxD)
qqnorm(d.inu.abx$MaxD)
qqline(d.inu.abx$MaxD)
shapiro.test(d.inu.abx$MaxD)
  # p-value = 0.02368
  # Not Normal
hist(d.inu.noabx$MaxD)
qqnorm(d.inu.noabx$MaxD)
qqline(d.inu.noabx$MaxD)
shapiro.test(d.inu.noabx$MaxD)
  # p-value = 0.1398
  # Normal



### Test Normality - Saline
hist(d.sal.abx$MaxD)
qqnorm(d.sal.abx$MaxD)
qqline(d.sal.abx$MaxD)
shapiro.test(d.sal.abx$MaxD)
  # p-value = 0.0002345
  # Not Normal
hist(d.sal.noabx$MaxD)
qqnorm(d.sal.noabx$MaxD)
qqline(d.sal.noabx$MaxD)
shapiro.test(d.sal.noabx$MaxD)
  # p-value = 1.386e-06
  # Not Normal



### Test BodyMass Correlation
cor.test(d.inu.abx$MaxD, d.inu.abx$BodyMass, method = "spearman")
  # p-value = 0.6887
cor.test(d.inu.noabx$MaxD, d.inu.noabx$BodyMass, method = "pearson")
  # p-value = 0.1138
cor.test(d.sal.abx$MaxD, d.sal.abx$BodyMass, method = "spearman")
  # p-value = 0.1803
cor.test(d.sal.noabx$MaxD, d.sal.noabx$BodyMass, method = "spearman")
  # p-value = 0.3421


### Test BodyTemp Correlation
cor.test(d.inu.abx$MaxD, d.inu.abx$BodyTemp, method = "spearman")
  # p-value = 0.8398
cor.test(d.inu.noabx$MaxD, d.inu.noabx$BodyTemp, method = "pearson")
  # p-value = 0.127
cor.test(d.sal.abx$MaxD, d.sal.abx$BodyTemp, method = "spearman")
  # p-value = 0.6429
cor.test(d.sal.noabx$MaxD, d.sal.noabx$BodyTemp, method = "spearman")
  # p-value = 0.6301


### Test Ketones Correlation
cor.test(d.inu.abx$MaxD, d.inu.abx$Ketones, method = "spearman")
  # p-value = 0.8832
cor.test(d.inu.noabx$MaxD, d.inu.noabx$Ketones, method = "spearman")
  # p-value = 0.02764*
  # rho = -0.5489832
cor.test(d.sal.abx$MaxD, d.sal.abx$Ketones, method = "spearman")
  # p-value = 0.7765
cor.test(d.sal.noabx$MaxD, d.sal.noabx$Ketones, method = "spearman")
  # p-value = 0.07819
```





### Test TimeMaxD
```{r}
### Test Normality - Inulin
hist(d.inu.abx$TimeMaxD)
qqnorm(d.inu.abx$TimeMaxD)
qqline(d.inu.abx$TimeMaxD)
shapiro.test(d.inu.abx$TimeMaxD)
  # p-value = 0.02942
  # Not Normal
hist(d.inu.noabx$TimeMaxD)
qqnorm(d.inu.noabx$TimeMaxD)
qqline(d.inu.noabx$TimeMaxD)
shapiro.test(d.inu.noabx$TimeMaxD)
  # p-value = 0.01792
  # Not Normal



### Test Normality - Saline
hist(d.sal.abx$TimeMaxD)
qqnorm(d.sal.abx$TimeMaxD)
qqline(d.sal.abx$TimeMaxD)
shapiro.test(d.sal.abx$TimeMaxD)
  # p-value = 0.05436
  # Normal
hist(d.sal.noabx$TimeMaxD)
qqnorm(d.sal.noabx$TimeMaxD)
qqline(d.sal.noabx$TimeMaxD)
shapiro.test(d.sal.noabx$TimeMaxD)
  # p-value = 0.1402
  # Normal



### Test BodyMass Correlation
cor.test(d.inu.abx$TimeMaxD, d.inu.abx$BodyMass, method = "spearman")
  # p-value = 0.8752
cor.test(d.inu.noabx$TimeMaxD, d.inu.noabx$BodyMass, method = "spearman")
  # p-value = 0.09366
cor.test(d.sal.abx$TimeMaxD, d.sal.abx$BodyMass, method = "spearman")
  # p-value = 0.006558*
  # rho = -0.6153847
cor.test(d.sal.noabx$TimeMaxD, d.sal.noabx$BodyMass, method = "pearson")
  # p-value = 0.7745


### Test BodyTemp Correlation
cor.test(d.inu.abx$TimeMaxD, d.inu.abx$BodyTemp, method = "spearman")
  # p-value = 0.3558
cor.test(d.inu.noabx$TimeMaxD, d.inu.noabx$BodyTemp, method = "spearman")
  # p-value = 0.9616
cor.test(d.sal.abx$TimeMaxD, d.sal.abx$BodyTemp, method = "pearson")
  # p-value = 0.3758
cor.test(d.sal.noabx$TimeMaxD, d.sal.noabx$BodyTemp, method = "pearson")
  # p-value = 0.9567


### Test Ketones Correlation
cor.test(d.inu.abx$TimeMaxD, d.inu.abx$Ketones, method = "spearman")
  # p-value = 0.1491
cor.test(d.inu.noabx$TimeMaxD, d.inu.noabx$Ketones, method = "spearman")
  # p-value = 0.8164
cor.test(d.sal.abx$TimeMaxD, d.sal.abx$Ketones, method = "spearman")
  # p-value = 0.01623*
  # rho = 0.6277548
cor.test(d.sal.noabx$TimeMaxD, d.sal.noabx$Ketones, method = "spearman")
  # p-value = 0.954
```





### Separate by substrate
```{r}
inu.all <- crds.sum[which(crds.sum$Substrate == "Inulin"),]
sal.all <- crds.sum[which(crds.sum$Substrate == "Saline"),]
```


### Calculate AUC
```{r}
# AUC = Area Under Curve
# Trapezoid Method

### Calculate AUC
ids <- unique(crds.rem$ID)
auc.df <- data.frame(crds.rem[1,])
auc.df <- auc.df[,-2:-3]
  # Remove Delta and CO2 cols
auc.df <- auc.df[,-13]
  # Remove BinTime col
colnames(auc.df) <- c("AUC", "Number", "ID", "Season", "Sex", "Antibiotics", "Substrate", "Diet", "Mom", "Mom_Location", "BodyMass", "BodyTemp")
auc.df$Ketones <- NA
  # Rename cols
meta <- read.csv('metadata.csv', fileEncoding="UTF-8-BOM")

#crds.rem= crds.bin
# First normalize Rel Time so 
#for (i in 2){
for (i in 1:length(ids)){
  ID <- ids[i]
  select <- crds.rem[which(crds.rem$ID == ID),]
    # Dataframe with CRDS values for 1 squirrel

  # Normalize delta value to baseline
  select$Delta <- select$Delta - select$Delta[1]
  
  # Remove baseline from AUC calculation because we care about the AUC after gavage
  # Since we already normalized delta value to baseline, we don't need that value anymore
  # Set baseline to gavage time = 0
  select[1,1] <- 0
  
  # Normalize AUC end time
  # Since length of experiment varies for each individual, we don't want experimental length to bias our AUC calculations
  # Normalize length to min time within each substrate
    # Inu = 4.0667
    # Sal = 2.21667
  if (select$Substrate == "Inulin") {
    max <- which(select$RelTime > 4.06667)
    select$RelTime[max] <- 4.06667
  } else if (select$Substrate == "Saline") {
    max <- which(select$RelTime > 2.21666667)
    select$RelTime[max] <- 2.21666667
  }

  # Create auc variable
  AUC <- 0
  
  # Run rectangle method integration - less accurate
  #for (j in 1:(nrow(select)-1)){
  #  AUC <- AUC + ((select$RelTime[j+1]-select$RelTime[j])*select$Delta[j+1])
  #}
  
  # Run trapezoid method integration - more accurate
  for(j in 1:(nrow(select)-1)){
    avgH <- (select$Delta[j+1]+select$Delta[j])/2
      # Calculates average height between start and end point
    width <- (select$RelTime[j+1]-select$RelTime[j])
    AUC <- AUC + (avgH*width)
  }
    
  auc.df[i,1] <- AUC
  auc.df[i, 2:12] <- select[1, 4:14]
  
  use <- which(meta$ID == ID)
  auc.df$Ketones[i] <- meta$Ketones[use]
}

#write.csv(auc.df, "auc.csv", row.names=F)


### Subset by Substrate & ABX
auc.inu <- auc.df[which(auc.df$Substrate == "Inulin"),]
auc.sal <- auc.df[which(auc.df$Substrate == "Saline"),]
auc.inu.s <- auc.inu[which(auc.inu$Season == "Summer"),]
auc.inu.w <- auc.inu[which(auc.inu$Season == "Winter"),]
auc.inu.p <- auc.inu[which(auc.inu$Season == "Spring"),]
auc.sal.s <- auc.sal[which(auc.sal$Season == "Summer"),]
auc.sal.w <- auc.sal[which(auc.sal$Season == "Winter"),]
auc.sal.p <- auc.sal[which(auc.sal$Season == "Spring"),]
auc.inu.abx <- auc.inu[which(auc.inu$Antibiotics == "Yes"),]
auc.inu.noabx <- auc.inu[which(auc.inu$Antibiotics == "No"),]
auc.sal.abx <- auc.sal[which(auc.sal$Antibiotics == "Yes"),]
auc.sal.noabx <- auc.sal[which(auc.sal$Antibiotics == "No"),]
```

### Test AUC
```{r}
### Test AUC Normality

# Inulin
hist(auc.inu.abx$AUC)
qqnorm(auc.inu.abx$AUC)
qqline(auc.inu.abx$AUC)
shapiro.test(auc.inu.abx$AUC)
  # p-value = 0.6626
  # Normal
hist(auc.inu.noabx$AUC)
qqnorm(auc.inu.noabx$AUC)
qqline(auc.inu.noabx$AUC)
shapiro.test(auc.inu.noabx$AUC)
  # p-value = 0.03022
  # Not Normal

# Saline
hist(auc.sal.abx$AUC)
qqnorm(auc.sal.abx$AUC)
qqline(auc.sal.abx$AUC)
shapiro.test(auc.sal.abx$AUC)
  # p-value = 0.9535
  # Normal
hist(auc.sal.noabx$AUC)
qqnorm(auc.sal.noabx$AUC)
qqline(auc.sal.noabx$AUC)
shapiro.test(auc.sal.noabx$AUC)
  # p-value = 0.277
  # Normal



### Test AUC - BodyMass Correlation ###

# Inulin
cor.test(auc.inu.abx$AUC, auc.inu.abx$BodyMass, method = "spearman")
  # p-value = 0.8768
cor.test(auc.inu.noabx$AUC, auc.inu.noabx$BodyMass, method = "spearman")
  # p-value = 0.3091

# Saline
cor.test(auc.sal.abx$AUC, auc.sal.abx$BodyMass, method = "spearman")
  # p-value = 0.4666
cor.test(auc.sal.noabx$AUC, auc.sal.noabx$BodyMass, method = "pearson")
  # p-value = 0.07001



### Test AUC - BodyTemp Correlation ###

# Inulin
cor.test(auc.inu.abx$AUC, auc.inu.abx$BodyTemp, method = "pearson")
  # p-value = 0.9251
cor.test(auc.inu.noabx$AUC, auc.inu.noabx$BodyTemp, method = "spearman")
  # p-value = 0.08249

# Saline
cor.test(auc.sal.abx$AUC, auc.sal.abx$BodyTemp, method = "pearson")
  # p-value = 0.6659
cor.test(auc.sal.noabx$AUC, auc.sal.noabx$BodyTemp, method = "pearson")
  # p-value = 0.3344





### Test AUC - Ketones Correlation ###

# Inulin
cor.test(auc.inu.abx$AUC, auc.inu.abx$Ketones, method = "spearman")
  # p-value = 0.3297
cor.test(auc.inu.noabx$AUC, auc.inu.noabx$Ketones, method = "spearman")
  # p-value = 0.3699

# Saline
cor.test(auc.sal.abx$AUC, auc.sal.abx$Ketones, method = "spearman")
  # p-value = 0.736
cor.test(auc.sal.noabx$AUC, auc.sal.noabx$Ketones, method = "spearman")
  # p-value = 0.08728
```


### Load/Test Inulinase RPKG
```{r}
### Exo - RPKG
exo_rpkg <- read.csv('eCAMI/inulinase/exoRPKG.csv')
exo_rpkg$Season <- ordered(exo_rpkg$Season, c("Summer", "Winter", "Spring"))

# Remove W20 outlier
exo_rpkg <- exo_rpkg[-which(exo_rpkg$Sample == "S-W20"),]


### Prepare AUC & slope data
for(sample in 1:nrow(exo_rpkg)){
  sampName <- substr(exo_rpkg$Sample[sample], 3, 5)
  useRow <- which(auc.df$ID == sampName)
  exo_rpkg$AUC[sample] <- auc.df$AUC[useRow]
  useRowD <- which(d.metrics$ID == sampName)
  exo_rpkg$Slope[sample] <- d.metrics$Slope[useRowD]
  exo_rpkg$SlopeTime[sample] <- d.metrics$SlopeTime[useRowD]
  exo_rpkg$MaxD[sample] <- d.metrics$MaxD[useRowD]
  exo_rpkg$TimeMaxD[sample] <- d.metrics$TimeMaxD[useRowD]
}

# Subset out inulin samples
exo_rpkg_inu <- exo_rpkg[1:9,]

# Test normality
hist(exo_rpkg_inu$RPKG)
qqnorm(exo_rpkg_inu$RPKG)
qqline(exo_rpkg_inu$RPKG)
shapiro.test(exo_rpkg_inu$RPKG)
  # p-value = 0.7523
  # Normal


### Test RPKG - AUC
cor.test(exo_rpkg_inu$RPKG, exo_rpkg_inu$AUC, method = "pearson")
  # p-value = 0.6815

### Test RPKG - Slope
cor.test(exo_rpkg_inu$RPKG, exo_rpkg_inu$Slope, method = "pearson")
  # p-value = 0.8562

### Test RPKG - SlopeTime
cor.test(exo_rpkg_inu$RPKG, exo_rpkg_inu$SlopeTime, method = "pearson")
  # p-value = 0.1434

### Test RPKG - MaxD
cor.test(exo_rpkg_inu$RPKG, exo_rpkg_inu$MaxD, method = "pearson")
  # p-value = 0.7158

### Test RPKG - TimeMaxD
cor.test(exo_rpkg_inu$RPKG, exo_rpkg_inu$TimeMaxD, method = "spearman")
  # p-value = 0.1938
```


### Load/Test DNA Yield
```{r}
# Load DNA data
dna <- read.csv('dna.csv')
dna$Season <- ordered(dna$Season, levels=c("Summer", "Winter", "Spring"))
dna <- dna[-which(dna$Squirrel == "S37"),]
#dna <- dna[-which(dna$Squirrel == "S28"),]
dna <- dna[-which(dna$Squirrel == "W43"),]
dna <- dna[-which(dna$Squirrel == "W50"),]
dna <- dna[-which(dna$Squirrel == "P04"),]
dna.con <- dna[which(substr(dna$Sample,2,2) == "C"),]


### Prepare AUC & slope data
dna.con <- dna.con[-which(dna.con$Squirrel == "P28"),]
dna.con <- dna.con[-which(dna.con$Squirrel == "S11"),]
dna.con <- dna.con[-which(dna.con$Squirrel == "S40"),]
for(sample in 1:nrow(dna.con)){
  sampName <- dna.con$Squirrel[sample]
  useRow <- which(auc.df$ID == sampName)
  dna.con$AUC[sample] <- auc.df$AUC[useRow]
  useRowD <- which(d.metrics$ID == sampName)
  dna.con$Slope[sample] <- d.metrics$Slope[useRowD]
  dna.con$SlopeTime[sample] <- d.metrics$SlopeTime[useRowD]
  dna.con$MaxD[sample] <- d.metrics$MaxD[useRowD]
  dna.con$TimeMaxD[sample] <- d.metrics$TimeMaxD[useRowD]
}

# Subset out inulin
dna.c.inu <- dna.con[which(dna.con$Substrate == "Inulin"),]

# Subset out ABX treatments
dna.c.inu.abx <- dna.c.inu[which(dna.c.inu$Antibiotics == "Antibiotics"),]
dna.c.inu.noabx <- dna.c.inu[which(dna.c.inu$Antibiotics == "No Antibiotics"),]



### Test Normality
hist(dna.c.inu$DNA_Yield_.ng.mg.)
qqnorm(dna.c.inu$DNA_Yield_.ng.mg.)
qqline(dna.c.inu$DNA_Yield_.ng.mg.)
shapiro.test(dna.c.inu$DNA_Yield_.ng.mg.)
  # p-value = 4.09e-05
  # Not Normal
hist(dna.c.inu.noabx$DNA_Yield_.ng.mg.)
qqnorm(dna.c.inu.noabx$DNA_Yield_.ng.mg.)
qqline(dna.c.inu.noabx$DNA_Yield_.ng.mg.)
shapiro.test(dna.c.inu.noabx$DNA_Yield_.ng.mg.)
  # p-value = 0.6838
  # Normal
hist(dna.c.inu.abx$DNA_Yield_.ng.mg.)
qqnorm(dna.c.inu.abx$DNA_Yield_.ng.mg.)
qqline(dna.c.inu.abx$DNA_Yield_.ng.mg.)
shapiro.test(dna.c.inu.abx$DNA_Yield_.ng.mg.)
  # p-value = 0.0003157
  # Not Normal
hist(dna.c.inu$AUC)
qqnorm(dna.c.inu$AUC)
qqline(dna.c.inu$AUC)
shapiro.test(dna.c.inu$AUC)
  # p-value = 1.06e-06
  # Not Normal
hist(dna.c.inu$Slope)
qqnorm(dna.c.inu$Slope)
qqline(dna.c.inu$Slope)
shapiro.test(dna.c.inu$Slope)
  # p-value = 1.076e-05
  # Not Normal
hist(dna.c.inu$SlopeTime)
qqnorm(dna.c.inu$SlopeTime)
qqline(dna.c.inu$SlopeTime)
shapiro.test(dna.c.inu$SlopeTime)
  # p-value = 0.001114
  # Not Normal
hist(dna.c.inu$MaxD)
qqnorm(dna.c.inu$MaxD)
qqline(dna.c.inu$MaxD)
shapiro.test(dna.c.inu$MaxD)
  # p-value = 2.952e-06
  # Not Normal
hist(dna.c.inu$TimeMaxD)
qqnorm(dna.c.inu$TimeMaxD)
qqline(dna.c.inu$TimeMaxD)
shapiro.test(dna.c.inu$TimeMaxD)
  # p-value = 8.742e-05
  # Not Normal


### Test
cor.test(dna.c.inu$DNA_Yield_.ng.mg., dna.c.inu$AUC, method = "spearman")
  # p-value = 7.727e-05*
cor.test(dna.c.inu$DNA_Yield_.ng.mg., dna.c.inu$Slope, method = "spearman")
  # p-value = 1.795e-06*
cor.test(dna.c.inu$DNA_Yield_.ng.mg., dna.c.inu$SlopeTime, method = "spearman")
  # p-value = 0.05915
cor.test(dna.c.inu$DNA_Yield_.ng.mg., dna.c.inu$MaxD, method = "spearman")
  # p-value = 9.042e-05
  # rho = 0.5790955
cor.test(dna.c.inu$DNA_Yield_.ng.mg., dna.c.inu$TimeMaxD, method = "spearman")
  # p-value = 2.295e-08
  # rho = 0.7515135


cor.test(dna.c.inu.noabx$DNA_Yield_.ng.mg., dna.c.inu.noabx$AUC, method = "spearman")
  # p-value = 0.1728
cor.test(dna.c.inu.noabx$DNA_Yield_.ng.mg., dna.c.inu.noabx$Slope, method = "pearson")
  # p- value = 0.9098
cor.test(dna.c.inu.noabx$DNA_Yield_.ng.mg., dna.c.inu.noabx$SlopeTime, method = "pearson")
  # p-value = 0.3932
cor.test(dna.c.inu.noabx$DNA_Yield_.ng.mg., dna.c.inu.noabx$MaxD, method = "pearson")
  # p-value = 0.1957
cor.test(dna.c.inu.noabx$DNA_Yield_.ng.mg., dna.c.inu.noabx$TimeMaxD, method = "spearman")
  # p-value = 0.9866



cor.test(dna.c.inu.abx$DNA_Yield_.ng.mg., dna.c.inu.abx$AUC, method = "spearman")
  # p-value = 0.6108
cor.test(dna.c.inu.abx$DNA_Yield_.ng.mg., dna.c.inu.abx$Slope, method = "spearman")
  # p-value = 0.03163*
  # rho = 0.4938496
cor.test(dna.c.inu.abx$DNA_Yield_.ng.mg., dna.c.inu.abx$SlopeTime, method = "spearman")
  # p-value = 0.3483
cor.test(dna.c.inu.abx$DNA_Yield_.ng.mg., dna.c.inu.abx$MaxD, method = "spearman")
  # p-value = 0.1794
cor.test(dna.c.inu.abx$DNA_Yield_.ng.mg., dna.c.inu.abx$TimeMaxD, method = "spearman")
  # p-value = 0.1186
```


### Hib Dates
```{r}
### Load data ###

# Dates
dates <- read.csv('metadata_dates.csv')
dates_use <- dates[-which(dates$Season == "Summer"),]
rownames(dates_use) <- 1:nrow(dates_use)
dates_use <- dates_use[-13:-28,]
rownames(dates_use) <- 1:nrow(dates_use)
dates_use <- dates_use[-33:-40,]
dates_use <- dates_use[-3,]
  # Remove outlier P04

# Add d metrics + AUC
for(k in 1:nrow(dates_use)){
  ID <- dates_use$ID[k]
  
  rowUse <- which(d.metrics$ID == ID)
  dates_use$Slope[k] <- d.metrics$Slope[rowUse]
  
  rowUse2 <- which(auc.df$ID == ID)
  dates_use$AUC[k] <- auc.df$AUC[rowUse2]
  
  rowUse3 <- which(dna.con$Squirrel == ID)
  dates_use$DNA_Yield[k] <- dna.con$DNA_Yield_.ng.mg.[rowUse3]
  dates_use$Slope[k] <- dna.con$Slope[rowUse3]
  dates_use$SlopeTime[k] <- dna.con$SlopeTime[rowUse3]
  dates_use$MaxD[k] <- dna.con$MaxD[rowUse3]
  dates_use$TimeMaxD[k] <- dna.con$TimeMaxD[rowUse3]
}
  
# Separate by Substrate
dates.inu <- dates_use[which(dates_use$Substrate == "Inulin"),]
dates.sal <- dates_use[which(dates_use$Substrate == "Saline"),]

# Separate by Substrate + Season
dates.inu.p <- dates.inu[which(dates.inu$Season == "Spring"),]
dates.inu.w <- dates.inu[which(dates.inu$Season == "Winter"),]
dates.sal.p <- dates.sal[which(dates.sal$Season == "Spring"),]
dates.sal.w <- dates.sal[which(dates.sal$Season == "Winter"),]


### Test normality ###

# Inulin Spring
hist(dates.inu.p$Days_Hib)
qqnorm(dates.inu.p$Days_Hib)
qqline(dates.inu.p$Days_Hib)
shapiro.test(dates.inu.p$Days_Hib)
  # p-value = 0.814
  # Normal
hist(dates.inu.p$IBA.Hib)
qqnorm(dates.inu.p$IBA.Hib)
qqline(dates.inu.p$IBA.Hib)
shapiro.test(dates.inu.p$IBA.Hib)
  # p-value = 0.4698
  # Normal
hist(dates.inu.p$Num_IBA)
qqnorm(dates.inu.p$Num_IBA)
qqline(dates.inu.p$Num_IBA)
shapiro.test(dates.inu.p$Num_IBA)
  # p-value = 0.347
  # Normal
hist(dates.inu.p$Slope)
qqnorm(dates.inu.p$Slope)
qqline(dates.inu.p$Slope)
shapiro.test(dates.inu.p$Slope)
  # p-value = 0.2886
  # Normal
hist(dates.inu.p$AUC)
qqnorm(dates.inu.p$AUC)
qqline(dates.inu.p$AUC)
shapiro.test(dates.inu.p$AUC)
  # p-value = 0.3911
  # Normal
hist(dates.inu.p$DNA_Yield)
qqnorm(dates.inu.p$DNA_Yield)
qqline(dates.inu.p$DNA_Yield)
shapiro.test(dates.inu.p$DNA_Yield)
  # p-value = 0.352
  # Normal
hist(dates.inu.p$SlopeTime)
qqnorm(dates.inu.p$SlopeTime)
qqline(dates.inu.p$SlopeTime)
shapiro.test(dates.inu.p$SlopeTime)
  # p-value = 0.5876
  # Normal
hist(dates.inu.p$MaxD)
qqnorm(dates.inu.p$MaxD)
qqline(dates.inu.p$MaxD)
shapiro.test(dates.inu.p$MaxD)
  # p-value = 0.1783
  # Normal
hist(dates.inu.p$TimeMaxD)
qqnorm(dates.inu.p$TimeMaxD)
qqline(dates.inu.p$TimeMaxD)
shapiro.test(dates.inu.p$TimeMaxD)
  # p-value = 0.8548
  # Normal



# Inulin Winter
hist(dates.inu.w$Days_Hib)
qqnorm(dates.inu.w$Days_Hib)
qqline(dates.inu.w$Days_Hib)
shapiro.test(dates.inu.w$Days_Hib)
  # p-value = 0.09684
  # Normal
hist(dates.inu.w$IBA.Hib)
qqnorm(dates.inu.w$IBA.Hib)
qqline(dates.inu.w$IBA.Hib)
shapiro.test(dates.inu.w$IBA.Hib)
  # p-value = 0.425
  # Normal
hist(dates.inu.w$Num_IBA)
qqnorm(dates.inu.w$Num_IBA)
qqline(dates.inu.w$Num_IBA)
shapiro.test(dates.inu.w$Num_IBA)
  # p-value = 0.517
  # Normal
hist(dates.inu.w$Slope)
qqnorm(dates.inu.w$Slope)
qqline(dates.inu.w$Slope)
shapiro.test(dates.inu.w$Slope)
  # p-value = 0.006649*
  # Not Normal
hist(dates.inu.w$AUC)
qqnorm(dates.inu.w$AUC)
qqline(dates.inu.w$AUC)
shapiro.test(dates.inu.w$AUC)
  # p-value = 0.0009432*
  # Not Normal
hist(dates.inu.w$DNA_Yield)
qqnorm(dates.inu.w$DNA_Yield)
qqline(dates.inu.w$DNA_Yield)
shapiro.test(dates.inu.w$DNA_Yield)
  # p-value = 0.01071*
  # Not Normal
hist(dates.inu.w$SlopeTime)
qqnorm(dates.inu.w$SlopeTime)
qqline(dates.inu.w$SlopeTime)
shapiro.test(dates.inu.w$SlopeTime)
  # p-value = 0.01045
  # Not Normal
hist(dates.inu.w$MaxD)
qqnorm(dates.inu.w$MaxD)
qqline(dates.inu.w$MaxD)
shapiro.test(dates.inu.w$MaxD)
  # p-value = 0.0005169
  # Not Normal
hist(dates.inu.w$TimeMaxD)
qqnorm(dates.inu.w$TimeMaxD)
qqline(dates.inu.w$TimeMaxD)
shapiro.test(dates.inu.w$TimeMaxD)
  # p-value = 0.01739
  # Not Normal



# Saline Spring
hist(dates.sal.p$Days_Hib)
qqnorm(dates.sal.p$Days_Hib)
qqline(dates.sal.p$Days_Hib)
shapiro.test(dates.sal.p$Days_Hib)
  # p-value = 0.6578
  # Normal
hist(dates.sal.p$IBA.Hib)
qqnorm(dates.sal.p$IBA.Hib)
qqline(dates.sal.p$IBA.Hib)
shapiro.test(dates.sal.p$IBA.Hib)
  # p-value = 0.7537
  # Normal
hist(dates.sal.p$Num_IBA)
qqnorm(dates.sal.p$Num_IBA)
qqline(dates.sal.p$Num_IBA)
shapiro.test(dates.sal.p$Num_IBA)
  # p-value = 0.221
  # Normal
hist(dates.sal.p$Slope)
qqnorm(dates.sal.p$Slope)
qqline(dates.sal.p$Slope)
shapiro.test(dates.sal.p$Slope)
  # p-value = 0.4823
  # Normal
hist(dates.sal.p$AUC)
qqnorm(dates.sal.p$AUC)
qqline(dates.sal.p$AUC)
shapiro.test(dates.sal.p$AUC)
  # p-value = 0.9211
  # Normal
hist(dates.sal.p$DNA_Yield)
qqnorm(dates.sal.p$DNA_Yield)
qqline(dates.sal.p$DNA_Yield)
shapiro.test(dates.sal.p$DNA_Yield)
  # p-value = 0.1695
  # Normal
hist(dates.sal.p$SlopeTime)
qqnorm(dates.sal.p$SlopeTime)
qqline(dates.sal.p$SlopeTime)
shapiro.test(dates.sal.p$SlopeTime)
  # p-value = 0.8502
  # Normal
hist(dates.sal.p$MaxD)
qqnorm(dates.sal.p$MaxD)
qqline(dates.sal.p$MaxD)
shapiro.test(dates.sal.p$MaxD)
  # p-value = 0.01553
  # Not Normal
hist(dates.sal.p$TimeMaxD)
qqnorm(dates.sal.p$TimeMaxD)
qqline(dates.sal.p$TimeMaxD)
shapiro.test(dates.sal.p$TimeMaxD)
  # p-value = 0.3634
  # Normal





# Saline Winter
hist(dates.sal.w$Days_Hib)
qqnorm(dates.sal.w$Days_Hib)
qqline(dates.sal.w$Days_Hib)
shapiro.test(dates.sal.w$Days_Hib)
  # p-value = 0.5809
  # Normal
hist(dates.sal.w$IBA.Hib)
qqnorm(dates.sal.w$IBA.Hib)
qqline(dates.sal.w$IBA.Hib)
shapiro.test(dates.sal.w$IBA.Hib)
  # p-value = 0.4521
  # Normal
hist(dates.sal.w$Num_IBA)
qqnorm(dates.sal.w$Num_IBA)
qqline(dates.sal.w$Num_IBA)
shapiro.test(dates.sal.w$Num_IBA)
  # p-value = 0.391
  # Normal
hist(dates.sal.w$Slope)
qqnorm(dates.sal.w$Slope)
qqline(dates.sal.w$Slope)
shapiro.test(dates.sal.w$Slope)
  # p-value = 3.109e-06*
  # Not Normal
hist(dates.sal.w$AUC)
qqnorm(dates.sal.w$AUC)
qqline(dates.sal.w$AUC)
shapiro.test(dates.sal.w$AUC)
  # p-value = 0.0003896*
  # Not Normal
hist(dates.sal.w$DNA_Yield)
qqnorm(dates.sal.w$DNA_Yield)
qqline(dates.sal.w$DNA_Yield)
shapiro.test(dates.sal.w$DNA_Yield)
  # p-value = 0.1583
  # Normal
hist(dates.sal.w$SlopeTime)
qqnorm(dates.sal.w$SlopeTime)
qqline(dates.sal.w$SlopeTime)
shapiro.test(dates.sal.w$SlopeTime)
  # p-value = 0.03469
  # Not Normal
hist(dates.sal.w$MaxD)
qqnorm(dates.sal.w$MaxD)
qqline(dates.sal.w$MaxD)
shapiro.test(dates.sal.w$MaxD)
  # p-value = 6.777e-07
  # Not Normal
hist(dates.sal.w$TimeMaxD)
qqnorm(dates.sal.w$TimeMaxD)
qqline(dates.sal.w$TimeMaxD)
shapiro.test(dates.sal.w$TimeMaxD)
  # p-value = 0.06743
  # Normal



### Correlate Hib Dates ###

# Inulin Spring - Slope
cor.test(dates.inu.p$Days_Hib, dates.inu.p$Slope, method = "pearson")
  # p-value = 0.8691
cor.test(dates.inu.p$IBA.Hib, dates.inu.p$Slope, method = "pearson")
  # p-value = 0.8053
cor.test(dates.inu.p$Num_IBA, dates.inu.p$Slope, method = "pearson")
  # p-value = 0.8329

# Inulin Spring - AUC
cor.test(dates.inu.p$Days_Hib, dates.inu.p$AUC, method = "pearson")
  # p-value = 0.3325
cor.test(dates.inu.p$IBA.Hib, dates.inu.p$AUC, method = "pearson")
  # p-value = 0.5419
cor.test(dates.inu.p$Num_IBA, dates.inu.p$AUC, method = "pearson")
  # p-value = 0.4433

# Inulin Spring - DNA_Yield
cor.test(dates.inu.p$Days_Hib, dates.inu.p$DNA_Yield, method = "pearson")
  # p-value = 0.3117
cor.test(dates.inu.p$IBA.Hib, dates.inu.p$DNA_Yield, method = "pearson")
  # p-value = 0.4015
cor.test(dates.inu.p$Num_IBA, dates.inu.p$DNA_Yield, method = "pearson")
  # p-value = 0.3104

# Inulin Spring - SlopeTime
cor.test(dates.inu.p$Days_Hib, dates.inu.p$SlopeTime, method = "pearson")
  # p-value = 0.8924
cor.test(dates.inu.p$IBA.Hib, dates.inu.p$SlopeTime, method = "pearson")
  # p-value = 0.8308
cor.test(dates.inu.p$Num_IBA, dates.inu.p$SlopeTime, method = "pearson")
  # p-value = 0.8077

# Inulin Spring - MaxD
cor.test(dates.inu.p$Days_Hib, dates.inu.p$MaxD, method = "pearson")
  # p-value = 0.523
cor.test(dates.inu.p$IBA.Hib, dates.inu.p$MaxD, method = "pearson")
  # p-value = 0.4702
cor.test(dates.inu.p$Num_IBA, dates.inu.p$MaxD, method = "pearson")
  # p-value = 0.4091

# Inulin Spring - TimeMaxD
cor.test(dates.inu.p$Days_Hib, dates.inu.p$TimeMaxD, method = "pearson")
  # p-value = 0.4632
cor.test(dates.inu.p$IBA.Hib, dates.inu.p$TimeMaxD, method = "pearson")
  # p-value = 0.6911
cor.test(dates.inu.p$Num_IBA, dates.inu.p$TimeMaxD, method = "pearson")
  # p-value = 0.7957



# Inulin Winter - Slope
cor.test(dates.inu.w$Days_Hib, dates.inu.w$Slope, method = "spearman")
  # p-value = 0.3001
cor.test(dates.inu.w$IBA.Hib, dates.inu.w$Slope, method = "spearman")
  # p-value = 1
cor.test(dates.inu.w$Num_IBA, dates.inu.w$Slope, method = "spearman")
  # p-value = 0.431

# Inulin Winter - AUC
cor.test(dates.inu.w$Days_Hib, dates.inu.w$AUC, method = "spearman")
  # p-value = 0.7126
cor.test(dates.inu.w$IBA.Hib, dates.inu.w$AUC, method = "spearman")
  # p-value = 0.6818
cor.test(dates.inu.w$Num_IBA, dates.inu.w$AUC, method = "spearman")
  # p-value = 0.788

# Inulin Winter - DNA_Yield
cor.test(dates.inu.w$Days_Hib, dates.inu.w$DNA_Yield, method = "spearman")
  # p-value = 0.01408
cor.test(dates.inu.w$IBA.Hib, dates.inu.w$DNA_Yield, method = "spearman")
  # p-value = 0.5599
cor.test(dates.inu.w$Num_IBA, dates.inu.w$DNA_Yield, method = "spearman")
  # p-value = 0.6119

# Inulin Winter - SlopeTime
cor.test(dates.inu.w$Days_Hib, dates.inu.w$SlopeTime, method = "spearman")
  # p-value = 0.007245*
  # rho = 0.7841982
cor.test(dates.inu.w$IBA.Hib, dates.inu.w$SlopeTime, method = "spearman")
  # p-value = 0.9728
cor.test(dates.inu.w$Num_IBA, dates.inu.w$SlopeTime, method = "spearman")
  # p-value = 0.2883

# Inulin Winter - MaxD
cor.test(dates.inu.w$Days_Hib, dates.inu.w$MaxD, method = "spearman")
  # p-value = 0.3833
cor.test(dates.inu.w$IBA.Hib, dates.inu.w$MaxD, method = "spearman")
  # p-value = 0.8916
cor.test(dates.inu.w$Num_IBA, dates.inu.w$MaxD, method = "spearman")
  # p-value = 0.3608

# Inulin Winter - TimeMaxD
cor.test(dates.inu.w$Days_Hib, dates.inu.w$TimeMaxD, method = "spearman")
  # p-value = 0.03021*
  # rho = 0.6808542
cor.test(dates.inu.w$IBA.Hib, dates.inu.w$TimeMaxD, method = "spearman")
  # p-value = 0.3677
cor.test(dates.inu.w$Num_IBA, dates.inu.w$TimeMaxD, method = "spearman")
  # p-value = 0.8141






# Saline Spring - Slope
cor.test(dates.sal.p$Days_Hib, dates.sal.p$Slope, method = "pearson")
  # p-value = 0.3953
cor.test(dates.sal.p$IBA.Hib, dates.sal.p$Slope, method = "pearson")
  # p-value = 0.4813
cor.test(dates.sal.p$Num_IBA, dates.sal.p$Slope, method = "pearson")
  # p-value = 0.8253

# Saline Spring - AUC
cor.test(dates.sal.p$Days_Hib, dates.sal.p$AUC, method = "pearson")
  # p-value = 0.4381
cor.test(dates.sal.p$IBA.Hib, dates.sal.p$AUC, method = "pearson")
  # p-value = 0.02985*
  # rho = -0.8554158
cor.test(dates.sal.p$Num_IBA, dates.sal.p$AUC, method = "pearson")
  # p-value = 0.1391

# Saline Spring - DNA_Yield
cor.test(dates.sal.p$Days_Hib, dates.sal.p$DNA_Yield, method = "pearson")
  # p-value = 0.0259*
  # rho = 0.8655442 
cor.test(dates.sal.p$IBA.Hib, dates.sal.p$DNA_Yield, method = "pearson")
  # rho = -0.02670578 
cor.test(dates.sal.p$Num_IBA, dates.sal.p$DNA_Yield, method = "pearson")
  # p-value = 0.3918

# Saline Spring - SlopeTime
cor.test(dates.sal.p$Days_Hib, dates.sal.p$SlopeTime, method = "pearson")
  # p-value = 0.7059
cor.test(dates.sal.p$IBA.Hib, dates.sal.p$SlopeTime, method = "pearson")
  # p-value = 0.4259
cor.test(dates.sal.p$Num_IBA, dates.sal.p$SlopeTime, method = "pearson")
  # p-value = 0.5572

# Saline Spring - MaxD
cor.test(dates.sal.p$Days_Hib, dates.sal.p$MaxD, method = "spearman")
  # p-value = 0.08014
cor.test(dates.sal.p$IBA.Hib, dates.sal.p$MaxD, method = "spearman")
  # p-value = 0.0206
  # rho = -0.8804063
cor.test(dates.sal.p$Num_IBA, dates.sal.p$MaxD, method = "spearman")
  # p-value = 0.4315

# Saline Spring - TimeMaxD
cor.test(dates.sal.p$Days_Hib, dates.sal.p$TimeMaxD, method = "pearson")
  # p-value = 0.9531
cor.test(dates.sal.p$IBA.Hib, dates.sal.p$TimeMaxD, method = "pearson")
  # p-value = 0.6576
cor.test(dates.sal.p$Num_IBA, dates.sal.p$TimeMaxD, method = "pearson")
  # p-value = 0.6511




# Saline Winter - Slope
cor.test(dates.sal.w$Days_Hib, dates.sal.w$Slope, method = "spearman")
  # p-value = 0.9599
cor.test(dates.sal.w$IBA.Hib, dates.sal.w$Slope, method = "spearman")
  # p-value = 0.8916
cor.test(dates.sal.w$Num_IBA, dates.sal.w$Slope, method = "spearman")
  # p-value = 0.8799

# Saline Winter - AUC
cor.test(dates.sal.w$Days_Hib, dates.sal.w$AUC, method = "spearman")
  # p-value = 0.6732
cor.test(dates.sal.w$IBA.Hib, dates.sal.w$AUC, method = "spearman")
  # p-value = 0.9728
cor.test(dates.sal.w$Num_IBA, dates.sal.w$AUC, method = "spearman")
  # p-value = 0.8141

# Saline Winter - DNA_Yield
cor.test(dates.sal.w$Days_Hib, dates.sal.w$DNA_Yield, method = "pearson")
  # p-value = 0.43
cor.test(dates.sal.w$IBA.Hib, dates.sal.w$DNA_Yield, method = "pearson")
  # p-value = 0.7003
cor.test(dates.sal.w$Num_IBA, dates.sal.w$DNA_Yield, method = "pearson")
  # p-value = 0.4399

# Saline Winter - SlopeTime
cor.test(dates.sal.w$Days_Hib, dates.sal.w$SlopeTime, method = "spearman")
  # p-value = 0.742
cor.test(dates.sal.w$IBA.Hib, dates.sal.w$SlopeTime, method = "spearman")
  # p-value = 0.1854
cor.test(dates.sal.w$Num_IBA, dates.sal.w$SlopeTime, method = "spearman")
  # p-value = 0.4453

# Saline Winter - MaxD
cor.test(dates.sal.w$Days_Hib, dates.sal.w$MaxD, method = "spearman")
  # p-value = 0.953
cor.test(dates.sal.w$IBA.Hib, dates.sal.w$MaxD, method = "spearman")
  # p-value = 0.7635
cor.test(dates.sal.w$Num_IBA, dates.sal.w$MaxD, method = "spearman")
  # p-value = 0.7614

# Saline Winter - TimeMaxD
cor.test(dates.sal.w$Days_Hib, dates.sal.w$TimeMaxD, method = "pearson")
  # p-value = 0.03251
  # cor = -0.6742094
cor.test(dates.sal.w$IBA.Hib, dates.sal.w$TimeMaxD, method = "pearson")
  # p-value = 0.7602
cor.test(dates.sal.w$Num_IBA, dates.sal.w$TimeMaxD, method = "pearson")
  # p-value = 0.4732





### Combine RPKG + Hib Dates
rpkg.dates <- exo_rpkg[which(exo_rpkg$Season != "Summer"),]

for(m in 1:nrow(rpkg.dates)){
  ID <- substr(rpkg.dates$Sample, 3, 5)[m]
  
  useRow <- which(dates_use$ID == ID)
  rpkg.dates$Days_Hib[m] <- dates_use$Days_Hib[useRow]
  rpkg.dates$IBA.Hib[m] <- dates_use$IBA.Hib[useRow]
  rpkg.dates$Num_IBA[m] <- dates_use$Num_IBA[useRow]
}

# Separate by Season
rpkg.dates.w <- rpkg.dates[which(rpkg.dates$Season == "Winter"),]
rpkg.dates.p <- rpkg.dates[which(rpkg.dates$Season == "Spring"),]

# Test Normality
hist(rpkg.dates.w$RPKG)
qqnorm(rpkg.dates.w$RPKG)
qqline(rpkg.dates.w$RPKG)
shapiro.test(rpkg.dates.w$RPKG)
  # p-value = 0.6909
  # Normal
hist(rpkg.dates.p$RPKG)
qqnorm(rpkg.dates.p$RPKG)
qqline(rpkg.dates.p$RPKG)
shapiro.test(rpkg.dates.p$RPKG)
  # p-value = 0.8464
  # Normal

hist(rpkg.dates.w$Days_Hib)
qqnorm(rpkg.dates.w$Days_Hib)
qqline(rpkg.dates.w$Days_Hib)
shapiro.test(rpkg.dates.w$Days_Hib)
  # p-value = 0.09208
  # Normal
hist(rpkg.dates.p$Days_Hib)
qqnorm(rpkg.dates.p$Days_Hib)
qqline(rpkg.dates.p$Days_Hib)
shapiro.test(rpkg.dates.p$Days_Hib)
  # p-value = 0.7618
  # Normal

hist(rpkg.dates.w$IBA.Hib)
qqnorm(rpkg.dates.w$IBA.Hib)
qqline(rpkg.dates.w$IBA.Hib)
shapiro.test(rpkg.dates.w$IBA.Hib)
  # p-value = 0.7023
  # Normal
hist(rpkg.dates.p$IBA.Hib)
qqnorm(rpkg.dates.p$IBA.Hib)
qqline(rpkg.dates.p$IBA.Hib)
shapiro.test(rpkg.dates.p$IBA.Hib)
  # p-value = 0.8422
  # Normal

hist(rpkg.dates.w$Num_IBA)
qqnorm(rpkg.dates.w$Num_IBA)
qqline(rpkg.dates.w$Num_IBA)
shapiro.test(rpkg.dates.w$Num_IBA)
  # p-value = 0.7583
  # Normal
hist(rpkg.dates.p$Num_IBA)
qqnorm(rpkg.dates.p$Num_IBA)
qqline(rpkg.dates.p$Num_IBA)
shapiro.test(rpkg.dates.p$Num_IBA)
  # p-value = 0.9208
  # Normal


### Correlate RPKG w/ Hib Dates ###
cor.test(rpkg.dates.w$Days_Hib, rpkg.dates.w$RPKG, method = "pearson")
  # p-value = 0.5756
cor.test(rpkg.dates.p$Days_Hib, rpkg.dates.p$RPKG, method = "pearson")
  # p-value = 0.3231

cor.test(rpkg.dates.w$IBA.Hib, rpkg.dates.w$RPKG, method = "pearson")
  # p-value = 0.6959
cor.test(rpkg.dates.p$IBA.Hib, rpkg.dates.p$RPKG, method = "pearson")
  # p-value = 0.8018

cor.test(rpkg.dates.w$Num_IBA, rpkg.dates.w$RPKG, method = "pearson")
  # p-value = 0.5854
cor.test(rpkg.dates.p$Num_IBA, rpkg.dates.p$RPKG, method = "pearson")
  # p-value = 0.9493
```