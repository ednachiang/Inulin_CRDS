---
title: "Code"
author: "Edna Chiang"
date: "February 5, 2018"
output: html_document
---

### Load Packages
```{r}
library(ggplot2)
library(dplyr)
```


### Load Data
```{r}
# x = This is the folder where all of your csv files for each squirrel (1 file per squirrel) are located 
# y = This is your metadata.csv file
# USE ' ' AROUND BOTH X & Y!!!

import.crds <- function(x,y) {
  
  # Load in all outside variables before you start the 'for' loop
  n <- as.numeric(length(list.files(x)))
  meta <- read.csv(y, fileEncoding="UTF-8-BOM")
  crds <- data.frame(matrix(ncol=9, nrow=0))
  
  # Import in each squirrel as its own dataframe
  for (i in 1:n){
    filename <- list.files(x)[i]
    id <- substr(filename, 1,4)
    wd <- paste0(x,"/",filename)
    df <- assign(paste0("crds.", id), read.csv(wd, header=T, fileEncoding="UTF-8-BOM"))
    rw <- which(meta[,1] == id)
    
    for (i in 1:6){
      cl = i
      df[,i+3] <- rep(meta[rw,cl],nrow(df))
      colnames(df)[i+3] <- colnames(meta)[cl]
      return(df)
    }
    
    return(df)
    assign(paste0("crds.", id), df)
    rownum <- nrow(df)
    
    if (i < 2){
      crds <- df
      return(crds)
    } else {
      crds <- rbind(crds, df)
      return(crds)
    }
    return(crds)
  }
}



crds <- crds[-which(is.na(crds[,2])),]

```


### Summarize by Substrate + ABX
```{r}
crds.sum <- crds %>%
  group_by(Substrate, ABX, Season, RelTime) %>%
  summarize(Mean = mean(Delta),
            Median = median(Delta),
            SD = sd(Delta),
            SE = se(Delta),
            iqr = IQR(Delta))


```

### Plot
```{r}
## All individuals
ggplot(crds, aes(x=RelTime, y=Delta, color=ID)) +
  geom_line() +
  geom_point()

## Substrate/ABX
ggplot(crds.sum, aes(x=RelTime, y=Mean, color=Substrate)) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = Mean-SE, ymax = Mean+SE))

```


### Extra Functions
```{r}
se <- function(x){
  sd(x)/sqrt(length(x))
}
```
